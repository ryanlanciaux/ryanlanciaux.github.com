{"data":{"site":{"siteMetadata":{"title":"Ryan Lanciaux","author":"Ryan Lanciaux"}},"markdownRemark":{"id":"293c2bd0-554f-56fe-88c9-07758e9295bc","excerpt":"There are a lot of opinions around how to arrange a React project. In this post, I want to talk about feature folders and why I think they are a great choice…","html":"<p>There are a lot of opinions around how to arrange a React project. In this post, I want to talk about feature folders and why I think they are a great choice for React application structure.</p>\n<h2>Focus on the goal rather than the technology</h2>\n<p>In many languages and frameworks, the prevailing wisdom is to group like technologies together. For example, when starting a new Rails or .NET MVC project, we generally have a series of folders for Models, Views, Controllers, (sometimes services and other things as well). While we don’t often have these types of items in React — it is fairly common to see a Components directory, some sort of Utils directory, and if we’re using Redux, a folder for Reducers, Actions, Selectors, and so on. This works great when a project is smaller but over time, this can be unwieldy — especially when working with teams of people.</p>\n<p>Feature folders help eliminate some of these problems by placing everything that is unique to one area of the code together. For instance, if we were making a login feature, we would have a folder for Login and in this folder we would have our login components, actionCreators, reducers, selectors, etc. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">src\n|_ features/\n|___ cart/\n|_____ components/\n|_____ actionCreators.js\n|_____ index.js\n|_____ reducer.js\n|_____ selectors.js\n|___ product/\n|___ other/</code></pre></div>\n<p>This arranges our code by what the code’s mission is and how it contributes to the overall goal of the project rather than the technology. </p>\n<h2>This is not much of a mental leap for React developers</h2>\n<p>In React, we are used to structuring our application as a series of components. Where traditional applications are built with a number of HTML files, CSS files, and JavaScript files, a component can encapsulate all of these things.</p>\n<div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/062af7e6eb9aa650e5f0b64387f82527/7173d/perfect-slide.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 67.24137931034483%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACoUlEQVQ4y42TX0hTURzHL0FPgRRC9dKjEPUQRb0EEhT9e5BopZVoOYwwpUhM6iGqh8qwRMq50mHTuaWZVkZQT4GkhhLYSzlm+3fnlOnmlnd3u3927rdzzpbGIPAHH845v/v7/fj97vkeIRqNwuPxcAKBAILBIHw+HycSiYCZYRh8JYQgFArB7XbzeFEUeZzf74fX64UkSRBkWeaJC9EYFmNLiMUTWKR7dk78Xl4p+JeleBxBMYTQbBiz4TmE5+b5urAYhaqqELAGY53pug5jDbG8YExK46ZrHA09o7jeO4ZGSn33F9wdmISmE9oZgappPOF7IALHyA+8mfCgf8yNvrFpvBydxtvJGT6BAKJjZi4B4WgHhAPtEA5aKc8gFFuwzmRHUtHZ0EjTcZg5x6dwvMWOKtsASi0unGpzwvS0F9Vdg6sdRqQEyl604ETnQ5y0NcNEKeloQpXTAoWNSkdOpdM8YXDqK8rtrbj6ugsXXVZUu9phpnH1Q/ZsQaISeBO/sN4mQLBSnudoF1DYXQA5I8PIGJDkJE/o//kOpiEzaj42ovJ9HSqGa1E+XIO6TzdyHRqsw3lU9pWgzHkYZ13HcI5y2nEIlwbPQM0oIBkCWZZ4wsS3AVhspXD01cHWY0Zn9wV02CvhfHUlW1CmIxHRD+zeCmwvAHZuylK0ASguAtIp6IT+w1yH8c/9CN4xYba1BmLTeYgPKiDeL0f4SS1XgSBrOvSQH2T/NpA9hSB7N4Ps2wKyayPIkR2AkgKdGBotzCU08gHk3mWQtlsgjxtAHtWDNF8Dsd5evRQu3oyeI5Mju/9Xh3xPfSq9IE1RoCsqXxnMx2XDX8B/RGrkCZsZW6VkEssUdvMaPcupFCerw7ynlU9+QeZTaEfpnIyoY+Ubsz/1wHwb53cYHgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Perfect slide\"\n        title=\"\"\n        src=\"/static/062af7e6eb9aa650e5f0b64387f82527/b9e4f/perfect-slide.png\"\n        srcset=\"/static/062af7e6eb9aa650e5f0b64387f82527/cf440/perfect-slide.png 148w,\n/static/062af7e6eb9aa650e5f0b64387f82527/d2d38/perfect-slide.png 295w,\n/static/062af7e6eb9aa650e5f0b64387f82527/b9e4f/perfect-slide.png 590w,\n/static/062af7e6eb9aa650e5f0b64387f82527/f9b6a/perfect-slide.png 885w,\n/static/062af7e6eb9aa650e5f0b64387f82527/7173d/perfect-slide.png 928w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</div>\n<p><a href=\"https://speakerdeck.com/didoo/let-there-be-peace-on-css\">from Cristiano Rastelli’s “Let There Be Peace on CSS” talk</a></p>\n<p>What’s interesting about this vision of separation of concerns is that it also reminiscent of the “Vertical Slices” terminology that is commonly used in some agile development circles (and also used as an argument for using feature folders). Instead of thinking of a system as a series of Actions, Reducers, Selectors, Components, an application can be imagined as a series of features. Features, at this point, can almost be seen as “components” of application structure.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d8418980acc11f9350402cf2e47a8b41/f21ab/vertical-slices.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.08510638297872%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADAUlEQVQ4y3XUfUjUdxzAcWF/RBZBW/ZABGuNxsDoRGt21rYGRbXV2ooSKrMcVmdntWSGM7GyJyh6pKWe+XiPbqd3Z/dgd95d3al07i4yTw31FjWoDcuKJGrr3ff6SQVXP3jx+T3x5veFL784W6SP6q5i1OETGHobxHkRmu5SrJEh4TFNAw+5OPDoFVsklv2vR5j7H9Iz+JToEfeF1kZ2s4xN9kUsMeax3ZVIetNqppReZ2pZD9Mruvl4xOTScIypZd3En+lkX9s9KZiqd7HLvYBtzh9Zbioi3ysn057JxPIw0y708XltHzNrJJPKb5JQ1ktCea80hcmqm4w6201x+z9ScIfdgbIljR2u71E4fmWnJxWlcwObG6+zsSFMhvHGa5sau2L8ZAqTXt+J/sZdKai3nEPpnk++61uOWreS45ZT2LyaRkMtlnotlt+1NI0wGzSY9GpMhjfM4p0/6qrouhaUgirjeRTNcnY7llFiVZBZn0ye6Qeq6jSotUY0OonO0EhNnYHKai1VQuWI6lodZaoaAh0hKXjRc5qNuhR2mhdzyp3NurokCm0rcTtUeGwVguotFTG89kpclt/o77kqBe8EEtlsnMce6zwM/tmkq+Ucdc7lRftH0P6hkCBMEMR12/hY0ee+D+BWES+iwdu+BBSur9jbIkfv+YS16vkcccjAGydpHSvEwxVx7nmH6DtOoV8pBbvaviGn5UsK3V9TLbbMFtdCjngW8K8viQc+Gfej/Elivoc/hUHvpwxHTkhLXnquiVx3mtgyK1ij3UPelVSyLOuZvb+DWfuuCUESi4Niht5JdiDE9IIOjl/6WwrKDhvZJb5oq30lSyt/Id+XRkbDesYqLzNmeyszCq4KASbubmd0jl/c8xP/lnG5rcRleSloiEjB786byb4kI8u6iFWan8XyZ5FhWsWcQwGSS0LMORgUQqSImVwSa+6hEJ/tDXDSeUcKDtyPcDqYy4XOYuwDOk7+qRA/h2MMPnnK0PB/PHjyTHj+XkPD0hx+9v+r4EuqVh+af9GYgwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Vertical slices in a React application\"\n        title=\"\"\n        src=\"/static/d8418980acc11f9350402cf2e47a8b41/b9e4f/vertical-slices.png\"\n        srcset=\"/static/d8418980acc11f9350402cf2e47a8b41/cf440/vertical-slices.png 148w,\n/static/d8418980acc11f9350402cf2e47a8b41/d2d38/vertical-slices.png 295w,\n/static/d8418980acc11f9350402cf2e47a8b41/b9e4f/vertical-slices.png 590w,\n/static/d8418980acc11f9350402cf2e47a8b41/f21ab/vertical-slices.png 611w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2>What about shared code?</h2>\n<p>Shared code can (and should) still exist in a feature based paradigm. There are some things that benefit many features and those could live in a “shared” directory.</p>\n<h2>A non-exhaustive example</h2>\n<p>To illustrate how we could migrate an application to this strategy, lets compare the <a href=\"https://github.com/reactjs/redux/tree/master/examples/shopping-cart\">Redux Shopping Cart</a> to a <a href=\"https://github.com/ryanlanciaux/react_feature_folder_example\">more feature-oriented example I’ve created</a>. </p>\n<p>The initial example exists as a series of items arranged by technology (e.g. components / containers / actionCreators, etc.)</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/194010a28ecab8e7cf34ce86a3961c65/95223/redux-shopping-cart.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 28.510638297872337%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyElEQVQY022R2Q6DMAwE+f+f7ENbekAOwn0kW68LiKpEsthIyXgcslvZI/QLgISUgLppYX2lVVqPpu3AlVL6q3hS2dMNCuIBLgIIM85rMbOJD7Xmqm7gq6B11iTLzYDcTQjdsgNL62AFRohmATkBqLkTc+O0WYwnwGvR424mzEvcgTxMULVaHW3fpYWT75ndbvgQw3H+AoOMt13ezLgnnJnAYRgP7/r7vtnl1QlwVv0NWBirhhyNmUZG9gRyrz9sHZuZd2KMCvwAUx3QzzcZwyEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Redux Shopping cart example\"\n        title=\"\"\n        src=\"/static/194010a28ecab8e7cf34ce86a3961c65/b9e4f/redux-shopping-cart.png\"\n        srcset=\"/static/194010a28ecab8e7cf34ce86a3961c65/cf440/redux-shopping-cart.png 148w,\n/static/194010a28ecab8e7cf34ce86a3961c65/d2d38/redux-shopping-cart.png 295w,\n/static/194010a28ecab8e7cf34ce86a3961c65/b9e4f/redux-shopping-cart.png 590w,\n/static/194010a28ecab8e7cf34ce86a3961c65/f9b6a/redux-shopping-cart.png 885w,\n/static/194010a28ecab8e7cf34ce86a3961c65/2d849/redux-shopping-cart.png 1180w,\n/static/194010a28ecab8e7cf34ce86a3961c65/95223/redux-shopping-cart.png 1410w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>To migrate to a more feature-oriented method of structuring our code (there are some files like tests and other things like that I leave out of this guide):</p>\n<ol>\n<li>We’ll start by creating a folder named <code class=\"language-text\">features</code> with a <code class=\"language-text\">cart</code> and <code class=\"language-text\">product</code> feature as sub folders.</li>\n<li>Create <code class=\"language-text\">components</code> directories in the <code class=\"language-text\">products</code> and <code class=\"language-text\">cart</code> folders and move the <code class=\"language-text\">components</code> and <code class=\"language-text\">container</code> components into their respective directories. Product components go under <code class=\"language-text\">features/product/components</code> where Cart components go under <code class=\"language-text\">features/cart/components</code></li>\n<li>Move <code class=\"language-text\">reducers/cart.js</code> to <code class=\"language-text\">features/cart/reducer.js</code> and <code class=\"language-text\">reducers/product.js</code> to <code class=\"language-text\">features/product/reducer.js</code>. This could still be called cartReducer if desired, however, I generally prefer to name boilerplate items in a very generic manner (while still keeping components named very specific to their function). </li>\n<li>From here create a directory called <code class=\"language-text\">shared</code> and move <code class=\"language-text\">reducers/index</code> to <code class=\"language-text\">shared/reducer.js</code></li>\n<li>At this point, you can move the selectors from <code class=\"language-text\">shared/reducer.js</code> to their own file under their respective directory (view <a href=\"https://github.com/ryanlanciaux/react_feature_folder_example/blob/master/src/features/cart/selectors.js\">features/cart/selectors.js</a> and <a href=\"https://github.com/ryanlanciaux/react_feature_folder_example/blob/master/src/features/product/selectors.js\">features/product/selectors.js</a>. I would generally recommend creating a <code class=\"language-text\">shared/selectors.js</code> file for containing selectors that are a combination of items that span more than one feature (<a href=\"https://github.com/ryanlanciaux/react_feature_folder_example/blob/master/src/shared/selectors.js\">see an example of this here</a>).</li>\n<li>Move the methods from <code class=\"language-text\">/actions/index.js</code> to <code class=\"language-text\">features/cart/actionCreators.js</code> or <code class=\"language-text\">features/product/actionCreators.js</code>.</li>\n<li>Create index files in each feature that export the main component as a default component and the other items as named exports. In this shopping cart example, the container component is the default export for both <code class=\"language-text\">cart</code> and <code class=\"language-text\">product</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> Product <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/ProductsContainer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> actionCreators <span class=\"token keyword\">from</span> <span class=\"token string\">'./actionCreators'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> selectors <span class=\"token keyword\">from</span> <span class=\"token string\">'./selectors'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> reducer <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> actionCreators<span class=\"token punctuation\">,</span> selectors<span class=\"token punctuation\">,</span> reducer <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Product<span class=\"token punctuation\">;</span></code></pre></div>\n<br />\n<p>Once these steps are complete — we can update any references to point to their new locations. <strong>One thing of important note</strong>: it’s generally a good idea to reference any part of a feature through the feature’s <code class=\"language-text\">index</code> rather than the file directly. This treats the index as each feature’s API contract and quickly illuminates any issues that may occur with any refactoring.</p>\n<p />\n<p><a href=\"https://github.com/ryanlanciaux/react_feature_folder_example\">View the example on GitHub</a></p>\n<h2>Benefits of this model</h2>\n<h4>Code is structured in a way that reflects purpose</h4>\n<p>This makes it easier to find files and know where things belong. Additionally, it helps clarify how a bit of code contributes to the overall goals of an application.</p>\n<h4>Code is easier to refactor</h4>\n<p>If a feature has one entry point, it’s clear that removing the feature will have limited impact on the rest of the system. Additionally, if changes are made to a login feature, they should have no impact on a “cart” feature.</p>\n<h4>Imagine applications a series of smaller applications</h4>\n<p>I like thinking of features as small applications that work together to a greater goal — kind of like the <a href=\"https://en.wikipedia.org/wiki/Unix_philosophy\">Unix Philosophy</a> “Write <em>features</em> that do one thing and do it well. Write <em>features</em> to work together.”</p>\n<h4>Feature Flags</h4>\n<p><small>(feature is kind of an overloaded term here)</small></p>\n<p><a href=\"https://stackoverflow.com/a/11164444/1385358\">“Feature Flag is a technique to turn some functionality of your application off, via configuration, without deploying new code.”</a>. While not entirely related, organizing an application as a series of features can make feature flags easier to implement. </p>\n<p>If we have a feature, buyNow structured as follows</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...\n|_ src/\n|___ features/\n|_____ buyNow/\n|_______ components/\n|_________ BuyNowButton.js\n|_______ index.js\n|_____ otherFeature</code></pre></div>\n<p>And our index for our buyNow feature looks like this</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> BuyNowButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/BuyNowButton'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> BuyNowButton<span class=\"token punctuation\">;</span></code></pre></div>\n<p>We could have a simple feature / featureCheck for turning parts of our application on and off</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// overly simplistic for sake of example</span>\n<span class=\"token keyword\">const</span> features <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  buyNow<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// overly simplistic for sake of example</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">isFeatureEnabled</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">feature</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> features<span class=\"token punctuation\">[</span>feature<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We could adjust our index to return undefined instead of the component if the feature was disabled</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> isFeatureEnabled <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../shared/features'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> BuyNowButton <span class=\"token keyword\">from</span> <span class=\"token string\">'./components/BuyNowButton'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ideally we would create something a bit more sophisticated for handling feature flags</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">isFeatureEnabled</span><span class=\"token punctuation\">(</span><span class=\"token string\">'buyNow'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> BuyNowButton <span class=\"token punctuation\">:</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>When the <code class=\"language-text\">buyNow</code> feature is set to false in the featureFlag file, the component will not render.</p>\n<h2>Wrapping up</h2>\n<ul>\n<li>Structure application by features</li>\n<li>Feature is a vertical slice through application layers</li>\n<li>There should be some value when feature is done</li>\n<li>Organizing files by feature allows for quicker deletion/refactoring</li>\n</ul>\n<p><a href=\"https://github.com/ryanlanciaux/react_feature_folder_example\">Feature example available here</a></p>\n<h2>Additional Resources</h2>\n<ul>\n<li><a href=\"https://speakerdeck.com/didoo/let-there-be-peace-on-css\">Let There Be Peace On CSS by Cristiano Rastelli</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/magazine/mt763233.aspx\">Feature slices in .NET Core</a></li>\n<li><a href=\"https://vimeo.com/131633177\">SOLID Architecture in Slices not Layers - Jimmy Bogard</a></li>\n</ul>","frontmatter":{"title":"A feature based approach to React development","date":"August 24, 2017","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2017-08-20-a-feature-based-approach-to-react-development/","previous":{"fields":{"slug":"/2017-08-20-releasing-node-packages/"},"frontmatter":{"title":"Releasing node packages"}},"next":{"fields":{"slug":"/2017-10-26-amazon-echo-costume/"},"frontmatter":{"title":"Amazon Echo Costume"}}}}