{"data":{"site":{"siteMetadata":{"title":"Ryan Lanciaux","author":"Ryan Lanciaux"}},"markdownRemark":{"id":"9aaec59a-7a53-5dc5-a324-a498c4aa2f44","excerpt":"In this article, we will discuss strategy that I like to help keep  Storybook  stories up-to-date. For those that are unfamiliar,  Storybook  is a UI component…","html":"\n          <div\n            class=\"gatsby-resp-iframe-wrapper\"\n            style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem\"\n          >\n            <iframe src=\"https://www.youtube.com/embed/C3UrkCVulaE\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          \"></iframe>\n          </div>\n          \n<p>In this article, we will discuss strategy that I like to help keep <a href=\"https://storybook.js.org/\">Storybook</a> stories up-to-date. For those that are unfamiliar, <a href=\"https://storybook.js.org/\">Storybook</a> is a UI component workspace that I find helpful in building front-end applications.</p>\n<p>It allows you to develop your components in isolation, interact with these components individually, and see quality issues at a much more granular level than the screen or page level. Additionally, this workspace serves as communication to other developers, noting the reusable components that exist in a system. <a href=\"https://storybook.js.org/\">Learn more about Storybook here</a>.</p>\n<p>One criticism I often hear is that it’s easy for a <a href=\"https://storybook.js.org/\">Storybook</a> project to get out-of-date when developers forget to add their components to Storybook. I often find that Storybook speeds up development but understand the tendency to build new components in the context of the live, running application. It’s easy to forget about adding stories when you have an otherwise working and tested feature.</p>\n<p>How do we keep this “building components in isolation” mindset top-of-mind in a way that provides immediate value to others may not necessarily develop their components in Storybook first? In this scenario, I often like to treat stories as part of my testing strategy.</p>\n<h2>Traditional Testing</h2>\n<p>Let’s assume we are building an activity feed. On our activity feed item component, we want to ensure that we’re rendering the correct text, and the button onClick event fires as expected. We could use <a href=\"https://testing-library.com/docs/react-testing-library/intro\">react-testing-library</a> to establish confidence that our component is working as anticipated.</p>\n<p>We’ll use the <code class=\"language-text\">render</code> utility to render the component that we wish to test. We’ll check the text and onClick functionality to ensure that everything is working.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ActivityFeedItem.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ActivityFeedItem</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">,</span> onClick <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Card<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Heading<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Heading<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>See Details<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Card<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ActivityFeedItem.test.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@testing-library/react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"shows the correct text\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> getByText <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>ActivityFeedItem\n      name<span class=\"token operator\">=</span><span class=\"token string\">\"This is the heading!\"</span>\n      text<span class=\"token operator\">=</span><span class=\"token string\">\"Sit enim irure pariatur nostrud id non deserunt laboris veniam velit.\"</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">getByText</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"Nostrud tempor ullamco aute nostrud commodo cillum amet ad velit veniam officia minim.\"</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeInTheDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>When we run our tests, we’ll see that all is working as expected.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Test Suites: 7 passed, 7 total\nTests:       9 passed, 9 total\nSnapshots:   5 passed, 5 total\nTime:        2.62s\nRan all test suites.</code></pre></div>\n<h2>Debugging failing tests</h2>\n<p>What happens if our test is failing, and we want to dive in to debug?</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Test Suites: 1 failed, 6 passed, 7 total</code></pre></div>\n<p>There are a couple of options but, one I use a lot is the <code class=\"language-text\">debug</code> utility from React testing library. This utility illuminates the HTML for the rendered element.</p>\n<p>We could update our test as follows to leverage <code class=\"language-text\">debug</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> getByText<span class=\"token punctuation\">,</span> debug <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>ActivityFeedItem\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"This is the heading!\"</span>\n    text<span class=\"token operator\">=</span><span class=\"token string\">\"Sit enim irure pariatur nostrud id non deserunt laboris veniam velit.\"</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The <code class=\"language-text\">debug</code> utility will log the HTML for our components. This strategy would work well for our trivial example component, but on a more substantial component, this can get unwieldy pretty quickly.</p>\n<p>Instead of defining our elements to render directly in our test, we can leverage Storybook stories for this. We’ll use stories written in Storybook’s <a href=\"https://storybook.js.org/docs/formats/component-story-format/\">component story format</a> to serve as the element we wish to <code class=\"language-text\">render</code> in our test.</p>\n<p>We’ll create the story metadata first. This metadata provides information to Storybook about how we should display our stories within the utility. Next, we’ll create a story with the component story format. You may notice that we’re creating an arrow function, which is not unique to Storybook. We can export this arrow function and import it in our test.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ActivityFeedItem.stories.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span> title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ActivityFeedItem\"</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">standard</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">callback <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>ActivityFeedItem\n      name<span class=\"token operator\">=</span><span class=\"token string\">\"This is the heading\"</span>\n      text<span class=\"token operator\">=</span><span class=\"token string\">\"Nostrud tempor ullamco aute nostrud commodo cillum amet ad velit veniam officia minim.\"</span>\n      onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>callback<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Using the story in our test</h2>\n<p>Before where we <code class=\"language-text\">rendered</code> our component in the test, we’ll use the imported story instead. Now, if we want to debug our test, we have a story we can use in addition to the other debugging strategies we may traditionally use.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> standard <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ActivityFeedItem.stories\"</span>\n\n<span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"shows the correct text\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> getByText <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token function\">standard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">getByText</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"Nostrud tempor ullamco aute nostrud commodo cillum amet ad velit veiam officia minim.\"</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeInTheDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n\n  <a class=\"gatsby-resp-image-link\" href=\"/static/2aa3e8498ba60f9ce0baef438f4a5da6/c6ee2/storybook_output.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.12634088200238%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABwElEQVQoz42R224SURSG50U4lDvCteVCMCY+glql9mTLoYnxksfoAxgTn0UTbkxIqlG0NdHIIUAZmBk2UGaY2XyuGQ5pvOpO/vx/9l5r/Wutbeymd0g/SLP7+AmPcg/J5/Pkcjmy2SyZTIZ4PE48FiMZj0W8k0yKTggnSKVSJBKJCEm5D2ON12dnnBaLlCrnFEslKsKVSoWj42MK+/s8e75HYe8pxZcvOCq84o3Enh+e8LZcolqtUiqXOTmVfMk9ODjEmP01af5u8afVwVYz1Mxl7rr4fsByuWRztOgg0IJgjZXWWuMtFnjegpFlY0zUHMuZMhpPsdQtMy9AKUW328U0TW76fTqdDq6YwFJMdGQUQa90WDR8s2xHOpy79CVpbFto35dWNL1ej1qtRqPR4PLyknq9TrvdZjgcMhgMIqOQbdveas9zccYK43PP4+Mvk0/XA+p9j+8jjWk5XF9d0Wy21u7rsUXfxaa7TYztSIcXXzzef7vlw0+fi68+734EOK7sTwfi6sku/e3e/i+4QfgWjmw7Y4yRM6En+yKQccMH4bufcZ+ziR+rCcZAPuXGUkxdXxBErPVyG3hfrAoq/gEHdmP9+IFyhAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"Storybook view of component\" title src=\"/static/2aa3e8498ba60f9ce0baef438f4a5da6/b9e4f/storybook_output.png\" srcset=\"/static/2aa3e8498ba60f9ce0baef438f4a5da6/cf440/storybook_output.png 148w,\n/static/2aa3e8498ba60f9ce0baef438f4a5da6/d2d38/storybook_output.png 295w,\n/static/2aa3e8498ba60f9ce0baef438f4a5da6/b9e4f/storybook_output.png 590w,\n/static/2aa3e8498ba60f9ce0baef438f4a5da6/c6ee2/storybook_output.png 839w\" sizes=\"(max-width: 590px) 100vw, 590px\">\n    </span>\n  </span>\n  \n  </a>\n    \n<p>We now have a way to visualize and interact with the component we’re testing.</p>\n<h2>Wrapping up</h2>\n<p>Storybook provides many benefits beyond testing, but sometimes it’s easy to forget when we’re trying to get features out the door. I’ve found that using Storybook as a tool to help ensure quality helps avoid this situation where stories become out-of-date or neglected.</p>\n<p>import { standard } from “./ActivityFeedItem.stories”;</p>","frontmatter":{"title":"Better testing with Storybook","date":"February 14, 2020","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2020/02/14/better-testing-with-storybook/","previous":{"fields":{"slug":"/blog/2020/01/31/optional-chaining-in-javascript/"},"frontmatter":{"title":"Optional Chaining in JavaScript","page":null}},"next":null}}