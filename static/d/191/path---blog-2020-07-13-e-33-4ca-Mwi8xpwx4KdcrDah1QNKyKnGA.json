{"data":{"site":{"siteMetadata":{"title":"Ryan Lanciaux","author":"Ryan Lanciaux"}},"markdownRemark":{"id":"cd8c0b43-f591-53e3-979b-f2fec7513c5e","excerpt":"GitHub profiles are a great addition to the platform. These profiles allow you to highlight your experience/interests and supply a little bit of personality to…","html":"<p>GitHub profiles are a great addition to the platform. These profiles allow you to highlight your experience/interests and supply a little bit of personality to what people see when they visit your profile. There are quite a few guides on creating a profile, but for those who may not have jumped into that just yet, you can add your profile by creating a new repository that matches your GitHub username. Any edits to the index.md file will show up when people vist github.com/{your<em>user</em>name}</p>\n<h2>Website Counter</h2>\n<p>I wanted to see if I could make my profile look a little bit like a website from the 1990s. A bit part of any 90s personal website is the visitor counter. We can create a fun (and not necessarily accurate) counter pretty quickly using node and express. I ended up using Glitch for mine, but this concept should work on any platform that supports node. </p>\n<h2>Node / Express project</h2>\n<p>The entire code for this project is posted below. Keep in mind this is mostly for fun — there are a lot of practices that we’d either want to avoid or clean up if it was for more of a production application. The key for me is something that could be accomplished in about 30 minutes or less. </p>\n<h2>Tracking visits</h2>\n<p>From a high level, this application has a variable that records visit counts, an endpoint that responds to count.svg and updates the visit counts. Additionally, the count.svg endpoint should generate and respond with an svg based on the count. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">const express = require(&#39;express&#39;)\nconst app = express()\n\nconst PLACES = 7;\n\n// no db - so global var to keep track of count\nlet counter = 0\n\nfunction getCountImage(count) {\n   ...\n}\n\n// get the image\napp.get(&#39;/count.svg&#39;, (req, res) =&gt; {\n  counter++;\n  \n  // This helps with GitHub&#39;s image cache \n  //   see more: https://rushter.com/counter.svg\n  res.set({\n  &#39;content-type&#39;: &#39;image/svg+xml&#39;,\n  &#39;cache-control&#39;: &#39;max-age=0, no-cache, no-store, must-revalidate&#39;\n  })\n  \n  // Send the generated SVG as the result\n  res.send(getCountImage(counter));\n})\n\nconst listener = app.listen(process.env.PORT, () =&gt; {\n  console.log(&#39;Your app is listening on port &#39; + listener.address().port)\n})</code></pre></div>\n<h2>Tracking visit count</h2>\n<p>We’re using the global counter variable to keep track of visits. When a request comes in to count.svg, we update the global counter variable and generate an image. </p>\n<h2>Generating an image</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function getCountImage(count) {\n  // This is not the greatest way for generating an SVG but it&#39;ll do for now\n  const countArray = count.toString().padStart(PLACES, &#39;0&#39;).split(&#39;&#39;);\n\n  const parts = countArray.reduce((acc, next, index) =&gt; `\n        ${acc}\n        &lt;rect id=&quot;Rectangle&quot; fill=&quot;#000000&quot; x=&quot;${index * 32}&quot; y=&quot;0.5&quot; width=&quot;29&quot; height=&quot;29&quot;&gt;&lt;/rect&gt;\n        &lt;text id=&quot;0&quot; font-family=&quot;Courier&quot; font-size=&quot;24&quot; font-weight=&quot;normal&quot; fill=&quot;#00FF13&quot;&gt;\n            &lt;tspan x=&quot;${index * 32 + 7}&quot; y=&quot;22&quot;&gt;${next}&lt;/tspan&gt;\n        &lt;/text&gt;\n`, &#39;&#39;);\n  \n  return `&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;svg width=&quot;${PLACES * 32}px&quot; height=&quot;30px&quot; version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;\n    &lt;title&gt;Count&lt;/title&gt;\n    &lt;g id=&quot;Page-1&quot; stroke=&quot;none&quot; stroke-width=&quot;1&quot; fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;&gt;\n      ${parts}\n    &lt;/g&gt;\n&lt;/svg&gt;\n}</code></pre></div>\n<p>I created an image in Sketch and copied the results as SVG and pasted it into the <code class=\"language-text\">getCountImage</code> method. You’ll notice in this function, we’re switching the count to a padded string, and then into an array. This allows us to show the zeros before the count with the specified number of PLACES. <code class=\"language-text\">const countArray = count.toString().padStart(PLACES, &#39;0&#39;).split(&#39;&#39;);</code> From there, we build the count squares part of the image by reducing the array into a single string, and then referencing that in the svg. </p>\n<h2>Additional references:</h2>\n<p>I started off referencing <a href=\"https://flaviocopes.com/count-visits-static-site/\">an analytics example by Flavio Copes</a> available here. In this example, Flavio created an svg that would collect website visit counts as a simple alternative to Google Analytics.  </p>\n<p>This <a href=\"https://rushter.com/blog/github-profile-markdown/\">article on the same topic by Artem Golubin</a> was really helpful in determining how to adjust the HTTP headers to work with GitHub’s image caching. <a href=\"https://docs.github.com/en/github/authenticating-to-github/about-anonymized-image-urls\">GitHub has an excellent feature that anonymizes browser details from images to help prevent tracking called Camo</a>. Without adjusting the HTTP headers, the image would not update upon new visits.</p>","frontmatter":{"title":"Quick GitHub profile visit counter","date":"July 13, 2020","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/2020/07/13//","previous":{"fields":{"slug":"/blog/2020/02/14/better-testing-with-storybook/"},"frontmatter":{"title":"Better testing with Storybook","page":null}},"next":null}}